# 盲棋术语记录功能设计文档

## 功能概述

在可视化棋盘右侧增加操作步骤记录，使用标准的盲棋术语表示每一步走法，为用户提供专业的象棋记录体验。

## 设计目标

1. **专业性**：使用标准的盲棋术语格式
2. **实时性**：每步走法后立即更新记录
3. **可读性**：清晰的布局和格式化显示
4. **历史性**：保留最近15步的走法记录

## 技术实现

### 核心方法

#### 1. `displayBoard()` 方法修改
- 在原有棋盘显示基础上，右侧增加历史记录区域
- 调用 `prepareHistoryDisplay()` 获取格式化的历史记录
- 使用分栏布局同时显示棋盘和历史记录

#### 2. `prepareHistoryDisplay()` 方法
```java
private List<String> prepareHistoryDisplay() {
    List<String> historyLines = new ArrayList<>();
    historyLines.add("📜 走法记录 (盲棋术语)");
    historyLines.add("─".repeat(20));
    
    // 获取最近15步记录
    int startIndex = Math.max(0, moveHistory.size() - 15);
    for (int i = startIndex; i < moveHistory.size(); i++) {
        String move = moveHistory.get(i);
        String blindNotation = convertToBlindNotation(move);
        historyLines.add(String.format("%2d. %s", i + 1, blindNotation));
    }
    
    return historyLines;
}
```

#### 3. `convertToBlindNotation()` 方法
- 解析原始走法描述
- 转换为标准盲棋术语格式
- 支持各种棋子类型的术语转换

#### 4. 辅助方法
- `parseCoordinate()`: 坐标解析
- `formatBlindNotation()`: 盲棋术语格式化

## 盲棋术语规则

### 棋子名称映射
- 帅/将 → 帅/将
- 仕/士 → 仕/士  
- 相/象 → 相/象
- 马 → 马
- 车 → 车
- 炮 → 炮
- 兵/卒 → 兵/卒

### 位置表示
- 纵线：一、二、三、四、五、六、七、八、九
- 横线：一、二、三、四、五、六、七、八、九、十

### 动作表示
- **进**：向前移动
- **退**：向后移动  
- **平**：横向移动

### 格式规范
`棋子名称 + 起始纵线 + 动作 + 目标位置`

例如：
- 马二进三：马从二路进到三路
- 车一平二：车从一路平移到二路
- 炮八进二：炮从八路向前进两格

## 显示效果

```
   一 二 三 四 五 六 七 八 九        📜 走法记录 (盲棋术语)
十 车 马 相 仕 将 仕 相 马 车        ────────────────────
九 ·  ·  ·  ·  ·  ·  ·  ·  ·         1. 马二进三
八 ·  炮 ·  ·  ·  ·  ·  炮 ·         2. 马八进七
七 兵 ·  兵 ·  兵 ·  兵 ·  兵        3. 车一平二
六 ·  ·  ·  ·  ·  ·  ·  ·  ·         4. 车九平八
五 ·  ·  ·  ·  ·  ·  ·  ·  ·         5. 炮二进二
四 ·  ·  ·  ·  ·  ·  ·  ·  ·         6. 炮八进二
三 兵 ·  兵 ·  兵 ·  兵 ·  兵        7. 马三进五
二 ·  炮 ·  ·  ·  ·  ·  炮 ·         8. 马七进五
一 车 马 象 士 帅 士 象 马 车        9. 车二进六
   红方                              10. 车八进六
```

## 功能特点

### 1. 实时更新
- 每次走法后自动更新记录
- 保持与游戏状态同步

### 2. 历史管理
- 显示最近15步走法
- 自动滚动显示最新记录
- 步数编号便于追踪

### 3. 专业术语
- 严格遵循盲棋术语标准
- 准确的棋子名称和动作描述
- 符合象棋界通用规范

### 4. 视觉优化
- 清晰的分栏布局
- 统一的格式化显示
- 易于阅读的字符对齐

## 用户体验提升

### 1. 学习价值
- 帮助用户学习标准盲棋术语
- 提升象棋记录能力
- 增强专业性认知

### 2. 复盘分析
- 清晰的走法记录便于复盘
- 步数编号方便定位
- 专业术语提升分析质量

### 3. 对弈体验
- 实时记录增强沉浸感
- 专业术语提升对弈档次
- 历史记录便于回顾思路

## 技术亮点

### 1. 智能解析
- 自动解析各种走法格式
- 准确识别棋子类型和位置
- 容错处理异常情况

### 2. 格式转换
- 坐标系统转换
- 术语标准化处理
- 动作类型智能判断

### 3. 性能优化
- 高效的字符串处理
- 最小化内存占用
- 快速的显示更新

## 后续优化方向

### 1. 功能扩展
- 支持导出走法记录
- 增加走法搜索功能
- 添加走法注释功能

### 2. 显示优化
- 支持颜色高亮显示
- 增加走法分类标记
- 优化移动端显示效果

### 3. 交互增强
- 点击走法回到历史状态
- 支持走法编辑功能
- 增加快捷键操作

## 测试验证

### 1. 功能测试
- 各种棋子的走法记录
- 特殊走法的术语转换
- 边界条件处理

### 2. 显示测试
- 不同终端尺寸适配
- 长时间对弈的记录管理
- 特殊字符显示兼容性

### 3. 性能测试
- 大量走法的处理性能
- 内存使用情况监控
- 显示更新响应速度

## 总结

盲棋术语记录功能为终端象棋游戏增加了专业性和实用性，通过标准的盲棋术语记录每一步走法，不仅提升了用户的对弈体验，还具有重要的学习和复盘价值。该功能的实现充分考虑了技术可行性、用户体验和性能优化，为后续功能扩展奠定了良好基础。