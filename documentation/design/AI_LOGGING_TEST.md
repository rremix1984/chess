# AI决策日志测试说明

## 功能概述
已成功为大模型AI集成了详细的决策过程日志记录功能，可以实时查看AI的思考过程。

## 测试步骤

### 1. 启动游戏
```bash
mvn exec:java -Dexec.mainClass="com.example.App"
```

### 2. 配置AI设置
1. 在游戏界面中，勾选"启用AI"复选框
2. 在"AI类型"下拉框中选择"大模型AI"
3. 在"模型选择"下拉框中选择"deepseek-r1:7b"（或其他可用模型）

### 3. 开始游戏并观察日志
- 进行一步棋后，AI会自动思考并移动
- 在控制台中会看到详细的决策日志

## 日志内容说明

### 主要决策流程日志
```
=== AI决策开始 ===
AI类型: 大模型AI (deepseek-r1:7b)
AI颜色: 红方/黑方
```

### HTTP请求日志
```
构建HTTP请求...
发送请求到: http://localhost:11434/api/generate
请求体大小: XXX 字节
```

### 响应处理日志
```
收到响应，状态码: 200
响应内容长度: XXX 字符
开始解析大模型响应...
```

### 移动解析日志
```
尝试解析标准格式移动...
尝试解析简单格式移动...
提取到坐标: 起始位置(x,y) -> 目标位置(x,y)
解析出移动: [棋子类型] 从 (x,y) 到 (x,y)
```

### 移动验证日志
```
验证移动有效性...
检查位置有效性: 通过
检查棋子存在性: 通过
检查棋子颜色: 通过
检查移动规则: 通过
检查移动安全性: 通过
移动验证: 有效
```

### 错误处理日志
如果大模型AI失败，会显示：
```
大模型AI决策失败，使用传统AI作为备选方案
传统AI建议移动: [棋子类型] 从 (x,y) 到 (x,y)
```

## 技术特性

### 1. 完整的决策链路追踪
- 从接收到移动请求开始
- 到最终执行移动结束
- 每个关键步骤都有详细记录

### 2. 错误处理和回退机制
- 大模型API调用失败时的处理
- 移动解析失败时的处理
- 自动回退到传统AI

### 3. 性能监控
- HTTP请求响应时间
- 移动解析耗时
- 整体决策耗时

### 4. 调试信息
- 详细的错误信息
- 中间处理结果
- 验证过程细节

## 注意事项

1. **Ollama服务**: 确保Ollama服务正在运行且模型已下载
2. **控制台输出**: 日志会输出到控制台，建议在终端中运行以查看完整日志
3. **性能影响**: 详细日志可能会影响性能，生产环境可考虑调整日志级别
4. **模型响应**: 不同模型的响应格式可能略有差异，解析器已做兼容处理

## 故障排除

### 如果看不到日志
1. 确认选择了"大模型AI"类型
2. 确认Ollama服务正常运行
3. 检查控制台输出

### 如果AI决策失败
1. 检查网络连接
2. 确认模型名称正确
3. 查看错误日志信息

## 扩展功能

未来可以考虑添加：
- 日志级别控制
- 日志文件输出
- 决策时间统计
- 移动质量评估
- 学习效果分析